
@inherits Nothing.Nauta.App.Components.ComponentBase<Nothing.Nauta.App.ViewModels.Pages.IndexViewModel>

@page "/"

@using System.Globalization

@if (ViewModel is null)
{
    return;
}

<PageTitle>Accounts</PageTitle>

<MudToolBar Style="margin-left: -10px; margin-right: -15px" >
    @if (ViewModel.IsSessionConnected)
    {
@*        <MudIcon Color="Color.Success" Icon="@Icons.Material.Filled.SignalWifi4Bar" Class="mr-5" />*@
        <MudText Typo="Typo.body1">CONNECTED</MudText>
    }
    else
    {
@*        <MudIcon Color="Color.Error" Icon="@Icons.Material.Filled.SignalWifiStatusbarConnectedNoInternet4" Class="mr-5" />*@
        <MudText Typo="Typo.body1">DISCONNECTED</MudText>
    }

    <MudSpacer/>
    <MudIconButton Icon="@Icons.Material.Filled.Add" Size="Size.Medium" OnClick="ViewModel.AddAccountAsync" Color="Color.Secondary" DisableElevation="true" />
    <MudIconButton Icon="@Icons.Material.Filled.Refresh" Size="Size.Medium" OnClick="ViewModel.ReloadAsync" Color="Color.Tertiary" DisableElevation="true" />
</MudToolBar>

@if (ViewModel.IsReloading)
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="true" Size="Size.Large" />
}
else if (ViewModel.Accounts?.Count > 0)
{
    <MudTable Items="@ViewModel.Accounts" Hover="true" LoadingProgressColor="Color.Info">
        <HeaderContent>
            <MudTh>User Name</MudTh>
            <MudTh>Account Type</MudTh>
            <MudTh>Remaining Time</MudTh>
            <MudTh/>
        </HeaderContent>
        <RowTemplate>
            <CascadingValue Value="ViewModel">
                <Nothing.Nauta.App.Components.AccountView ViewModel="@context"/>
            </CascadingValue>
        </RowTemplate>
    </MudTable>

    <br/>

@*   
    <MudButton Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.ClearAll" Color="Color.Error" Size="Size.Large" FullWidth="true" OnClick=@(async () => await ForceConnectionCloseAsync()) Disabled="@IsManualResetDisable()">Force Connection Close</MudButton>
*@

}
else
{
    <MudAlert Severity="Severity.Info">Add a new account</MudAlert>
}

<MudOverlay Visible="@ViewModel.IsOverlayVisible" DarkBackground="true">
    <MudProgressCircular Color="Color.Primary" Indeterminate="true" Size="Size.Large"/>
</MudOverlay>